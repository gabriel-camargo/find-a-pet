<!DOCTYPE html>

<html lang="pt" dir="ltr">

    <head>
        {include="pages/header"}
        <link rel="stylesheet" href="/node_modules/croppie/croppie.css">
        <style>
            .required{
                color: #ff1744;
                font-size: 20pt;
                vertical-align: middle;
            }
        </style>
    </head>

    <body>
        {include="pages/navbar"}

        <div class="container mt-3">
            <div class="card border-success">
                <h5 class="card-header bg-success text-white">Adicionar animal</h5>

                <div class="card-body px-4">
                    <form method="POST">

                        {if="$erro != NULL"}
                            <div class="alert alert-danger mt-3" role="alert">
                                {$erro}
                            </div>
                        {/if}

                        <!-- LINHA DO NOME E DA FOTO -->
                        <div class="form-row">
                            <!-- INPUT DA FOTO  -->
                            <div class="col-lg-4 col-md-12 form-group">
                                <div class="px-3 my-2">
                                    <div class="custom-file">
                                        <input type="file" class="custom-file-input" name="upload_image"
                                            id="upload_image" accept="image/*" />
                                        <label class="custom-file-label" for="customFile">
                                            Escolher foto
                                        </label>
                                    </div>
                                </div>
                                   
                                <div id="image_demo"></div>
                                
                            </div>

                            
                            <div class="col-lg-8 col-md-12">
                                <!-- input do nome  -->
                                <div class="form-row">
                                    <label for="inputNomeAnimal">Nome
                                        <span class="required">*</span>
                                    </label>
                                    <input value='{if="$old_post != NULL"}{$old_post.ani_nome}{/if}'
                                        name="ani_nome" type="text" class="form-control" id="inputNomeAnimal"
                                        placeholder="Insira o nome do animal" required>
                                </div>

                                <!-- input da especie -->
                                <div class="form-row mt-4">
                                        <label for="inputEspecieAnimal">Especie  <span class="required">*</span></label>
                                        <select name="esp_id" id="inputEspecieAnimal" class="custom-select">
                                            <option selected value=""> --- Selecione a espécie --- </option>                                        
                                            {loop="$especies"}
                                                <option value="{$value.esp_id}">{$value.esp_nome}</option>
                                            {/loop}
                                        </select>
                                </div>

                                <!-- input do sattus -->
                                <div class="form-row mt-4">
                                        <label for="inputStatusAnimal">Status  <span class="required">*</span></label>
                                        <select name="ani_status" id="inputStatusAnimal" class="custom-select">
                                            <option selected value=""> --- Selecione o status --- </option>
                                            {loop="$status"}
                                                <option value="{$key}">{$value}</option>
                                            {/loop}
                                        </select>
                                </div>
                            </div>             
                        </div>

                        <!-- LINHA DA FAIXA ETÁRIA E STATUS -->
                        <div class="form-row">
                            <!-- INPUT DO STATUS -->
                            <div class="col-lg-4 md-12 form-group">
                                    <label for=""> Sexo  <span class="required">*</span> </label>
                                    <br>
                                    <div class="custom-control custom-radio custom-control-inline mt-2">
                                        <input value="F" type="radio" id="ani_sexo_f" name="ani_sexo" class="custom-control-input">
                                        <label class="custom-control-label" for="ani_sexo_f">Fêmea</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline">
                                        <input value="M" type="radio" id="ani_sexo_m" name="ani_sexo" class="custom-control-input">
                                        <label class="custom-control-label" for="ani_sexo_m">Macho</label>
                                    </div>
                            </div>

                            <!-- INPUT DA FAIXA ETÁRIA -->
                            <div class="col-lg-4 md-12 form-group">
                                    <label for="inputFaixaEtaria"> Faixa etária  <span class="required">*</span></label>
                                    <select name="ani_faixa_etaria" id="inputFaixaEtaria" class="custom-select">
                                        <option selected value=""> --- Selecione a faixa etária --- </option>
                                        {loop="$faixa_etaria"}
                                            <option value="{$key}">{$value}</option>
                                        {/loop}
                                    </select>
                            </div>

                             <!-- INPUT DO PORTE -->
                             <div class="col-lg-4 md-12 form-group">
                                    <label for="inputPorteAnimal">Porte  <span class="required">*</span></label>
                                    <select name="ani_porte" id="inputPorteAnimal" class="custom-select">
                                        <option selected value=""> --- Selecione o porte --- </option>
                                        {loop="$porte"}
                                            <option value="{$key}">{$value}</option>
                                        {/loop}
                                    </select>
                            </div>

                            

                        </div>

                        <div class="form-row">
                            <div class="col form-group">
                                <label for="exampleFormControlTextarea1"> Outras informações </label>
                                <textarea name="ani_informacoes" class="form-control" id="exampleFormControlTextarea1" rows="5"
                                placeholder="Escreva um texto que informe para as pessoas sobre características sobre seu animal :)"></textarea>
                                          
                            </div>
                        </div>

                        <div class="row">
                            <div class="col">
                                    <button type="submit" class="btn btn-success px-4"> Salvar</button>
                            </div>
                            <div class="col text-right">
                                <span style="color: #ff1744">
                                     <span class="required">*</span> Campos obrigatórios 
                                </span>
                            </div>
                        </div>
                        
                    </form>

                </div>

            </div>
        </div>        

        {include="pages/footer"}
        <script src="/node_modules/exif-js/exif.js"></script>
        <script src="/node_modules/croppie/croppie.js"></script>
        <script>
            $(document).ready(function(){

                $image_crop = $('#image_demo').croppie({
                    enableExif: true,
                    viewport: {
                        width:200,
                        height:200,
                        type:'square'
                    },
                    boundary:{
                        width:250,
                        height:250
                    }
                });

                $('#upload_image').on('change', function(){
                    var reader = new FileReader();
                    reader.onload = function (event) {
                        $image_crop.croppie('bind', {
                            url: event.target.result
                        }).then(function(){
                            console.log('jQuery bind complete');
                        });
                    }
                    reader.readAsDataURL(this.files[0]);
                });

                $('.crop_image').click(function(event){
                        $image_crop.croppie('result', {
                        type: 'canvas',
                        size: 'viewport'
                    }).then(function(response){
                        $.ajax({
                            url:"/animal/save-img/",
                            type: "POST",
                            data:{"image": response},
                            success:function(data)
                            {
                                $('#uploadimageModal').modal('hide');
                                $('#uploaded_image').html(data);
                            }
                        });
                    })
                });
            });  
        </script>
    </body>
</html>